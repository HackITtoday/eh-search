
<link rel="import" href="../bower_components/polymer/polymer.html">

<polymer-element name="eh-search" >
  <template>
<script type='text/javascript' src='//code.jquery.com/jquery-1.11.0.js'></script>
<link rel="stylesheet" type="text/css" href="//twitter.github.io/typeahead.js/css/examples.css">
<style type='text/css'>
.essential .empty-message {
  padding: 5px 10px;
  text-align: center;
}
.hotels {
  color:red;
}
.destinations {
  color:green;
}
.attractions {
  color:blue;
}
#essential .tt-dropdown-menu {
  max-height: 150px;
  overflow-y: auto;
}
</style>

<script type='text/javascript'>//<![CDATA[ 
$(window).load(function(){
    var search = new Bloodhound({
datumTokenizer: Bloodhound.tokenizers.obj.whitespace('value'),
queryTokenizer: Bloodhound.tokenizers.whitespace,
prefetch:{ url:  "/wp-content/uploads/search.json"}
});

    search.initialize();

    $('.essential .typeahead').typeahead(null, {
name: 'search',
displayKey: 'value',
source: search.ttAdapter(),
templates: {
empty: [
'<div class="empty-message">',
'Can\'t Find Want Your Looking For? <br /> We\'d Love to Help Please <br /> Call <a href="tel:01189714700">0118 971 4700</a>, <a href="#!" onclick="$zopim.livechat.button.show();"> Chat </a>, or <a href="mailto:nick@essential-hotels.com"> Email </a>',
'</div>'
].join('\n'),
suggestion: Handlebars.compile('<p class="{{type}}">{{value}}</p>')
}
}).bind("typeahead:selected", function(obj, datum, name) {
  if (datum.url) {
  $(location).attr('href', datum.url);
  }
  }).bind("typeahead:cursorchanged", function(obj, datum, name) {
    console.log(obj, datum, name);
    if (datum.url) {
    /* $(location).attr('href', datum.url); */
    }
    });
});//]]>  

</script>
<center>
  <div class="essential">
    <input class="typeahead" type="text" placeholder="Hotel, City, Area or Interest"/>
  </div>
</center>

<script src="//twitter.github.io/typeahead.js/js/handlebars.js"></script>
<script src="//twitter.github.io/typeahead.js/releases/latest/typeahead.bundle.js"></script>
  </template>
  <script>Polymer('eh-search');</script>

</polymer-element>

